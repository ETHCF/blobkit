<!DOCTYPE html>
<html>
<head>
    <title>BlobKit Browser Test</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6/dist/ethers.umd.min.js"></script>
</head>
<body>
    <h1>BlobKit v1.0.5 Browser Test</h1>
    <div id="status">Loading...</div>
    <pre id="output"></pre>
    
    <script type="module">
        // Test imports - these should work without any errors
        import { 
            BlobKit, 
            initialize, 
            initializeFromUrl,
            encodeBlob, 
            decodeBlob,
            isBrowser,
            isNode 
        } from '../dist/browser.js';
        
        const status = document.getElementById('status');
        const output = document.getElementById('output');
        
        function log(message) {
            output.textContent += message + '\n';
        }
        
        async function runTests() {
            try {
                // Test 1: Environment detection
                log('=== Environment Detection ===');
                log(`isBrowser(): ${isBrowser()}`);
                log(`isNode(): ${isNode()}`);
                
                // Test 2: Initialize without parameters
                log('\n=== Initialization ===');
                log('Calling initialize()...');
                await initialize();
                log('✅ Initialize succeeded (using minimal setup in test)');
                
                // Test 3: Blob encoding/decoding
                log('\n=== Blob Operations ===');
                const testData = new TextEncoder().encode('Hello, BlobKit in browser!');
                log(`Original data: ${new TextDecoder().decode(testData)}`);
                
                const encoded = encodeBlob(testData, false); // No compression in browser
                log(`Encoded blob size: ${encoded.length} bytes`);
                
                const decoded = decodeBlob(encoded, false);
                log(`Decoded data: ${new TextDecoder().decode(decoded)}`);
                
                // Test 4: Create BlobKit instance
                log('\n=== BlobKit Instance ===');
                const config = { 
                    rpcUrl: 'https://eth-mainnet.g.alchemy.com/v2/demo' 
                };
                const privateKey = '0x' + '0'.repeat(64); // Dummy key for testing
                const signer = new ethers.Wallet(privateKey);
                
                const blobkit = new BlobKit(config, signer);
                log('✅ BlobKit instance created successfully');
                
                status.textContent = '✅ All tests passed!';
                status.style.color = 'green';
                
            } catch (error) {
                status.textContent = '❌ Test failed!';
                status.style.color = 'red';
                log(`\n❌ Error: ${error.message}`);
                console.error(error);
            }
        }
        
        // Run tests when page loads
        runTests();
    </script>
</body>
</html>